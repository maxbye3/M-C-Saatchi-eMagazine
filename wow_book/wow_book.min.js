/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
/* Modernizr 2.5.3 (Custom Build) | MIT & BSD
 * Build: http://www.modernizr.com/download/#-csstransforms3d-prefixed-teststyles-testprop-testallprops-prefixes-domprefixes
 */
(function(d,q,r){function t(a){a=a||location.href;return"#"+a.replace(/^[^#]*#?(.*)$/,"$1")}"$:nomunge";var j="hashchange",k=document,o,a=d.event.special,b=k.documentMode,c="on"+j in q&&(b===r||7<b);d.fn[j]=function(a){return a?this.bind(j,a):this.trigger(j)};d.fn[j].delay=50;a[j]=d.extend(a[j],{setup:function(){if(c)return!1;d(o.start)},teardown:function(){if(c)return!1;d(o.stop)}});o=function(){function a(){var b=t(),c=u(h);b!==h?(l(h=b,c),d(q).trigger(j)):c!==h&&(location.href=location.href.replace(/#.*/,
"")+c);g=setTimeout(a,d.fn[j].delay)}var b={},g,h=t(),i=function(a){return a},l=i,u=i;b.start=function(){g||a()};b.stop=function(){g&&clearTimeout(g);g=r};d.browser.msie&&!c&&function(){var c,g;b.start=function(){c||(g=(g=d.fn[j].src)&&g+t(),c=d('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){g||l(t());a()}).attr("src",g||"javascript:0").insertAfter("body")[0].contentWindow,k.onpropertychange=function(){try{"title"===event.propertyName&&(c.document.title=k.title)}catch(a){}})};
b.stop=i;u=function(){return t(c.location.href)};l=function(a,b){var f=c.document,e=d.fn[j].domain;a!==b&&(f.title=k.title,f.open(),e&&f.write('<script>document.domain="'+e+'"<\/script>'),f.close(),c.location.hash=a)}}();return b}()})(jQuery,this);
window.Modernizr=function(d,q,r){function t(a,c){for(var f in a)if(b[a[f]]!==r)return"pfx"==c?a[f]:!0;return!1}function j(a,b,e){var d=a.charAt(0).toUpperCase()+a.substr(1),g=(a+" "+c.join(d+" ")+d).split(" ");if("string"===typeof b||"undefined"===typeof b)b=t(g,b);else{g=(a+" "+f.join(d+" ")+d).split(" ");a:{var a=g,h;for(h in a)if(d=b[a[h]],d!==r){b=!1===e?a[h]:"function"===typeof d?d.bind(e||b):d;break a}b=!1}}return b}var k={},o=q.documentElement,a=q.createElement("modernizr"),b=a.style,d=["",
"-webkit-","-moz-","-o-","-ms-"],c=["Webkit","Moz","O","ms"],f=["webkit","moz","o","ms"],a={},e=[],g=e.slice,h,i=function(a,b,c,f){var e,d,g,h=q.createElement("div"),i=q.body,l=i?i:q.createElement("body");if(parseInt(c,10))for(;c--;)g=q.createElement("div"),g.id=f?f[c]:"modernizr"+(c+1),h.appendChild(g);return e=["&#173;<style>",a,"</style>"].join(""),h.id="modernizr",(i?h:l).innerHTML+=e,l.appendChild(h),i||(l.style.background="",o.appendChild(l)),d=b(h,a),i?h.parentNode.removeChild(h):l.parentNode.removeChild(l),
!!d},l={}.hasOwnProperty,u;"undefined"!==typeof l&&"undefined"!==typeof l.call?u=function(a,b){return l.call(a,b)}:u=function(a,b){return b in a&&"undefined"===typeof a.constructor.prototype[b]};Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;if("function"!=typeof b)throw new TypeError;var c=g.call(arguments,1),f=function(){if(this instanceof f){var e=function(){};e.prototype=b.prototype;var e=new e,d=b.apply(e,c.concat(g.call(arguments)));return Object(d)===d?d:e}return b.apply(a,
c.concat(g.call(arguments)))};return f});(function(a,b){var c=a.join(""),f=b.length;i(c,function(a){for(var a=a.childNodes,b={};f--;)b[a[f].id]=a[f];k.csstransforms3d=9===(b.csstransforms3d&&b.csstransforms3d.offsetLeft)&&3===b.csstransforms3d.offsetHeight},f,b)})([,["@media (",d.join("transform-3d),("),"modernizr){#csstransforms3d{left:9px;position:absolute;height:3px;}}"].join("")],[,"csstransforms3d"]);a.csstransforms3d=function(){var a=!!j("perspective");return a&&"webkitPerspective"in o.style&&
(a=k.csstransforms3d),a};for(var w in a)u(a,w)&&(h=w.toLowerCase(),k[h]=a[w](),e.push((k[h]?"":"no-")+h));b.cssText="";return a=null,k._version="2.5.3",k._prefixes=d,k._domPrefixes=f,k._cssomPrefixes=c,k.testProp=function(a){return t([a])},k.testAllProps=j,k.testStyles=i,k.prefixed=function(a,b,c){return b?j(a,b,c):j(a,"pfx")},k}(this,this.document);
(function(d){function q(a,b){var a=d(a),c=this;this.elem=a;this.id=a.attr("id");this.pages=[];this.opts=b;this.currentPage=null;this.pageWidth=b.width/2;this.pageHeight=b.height;this.transparentPages=b.transparentPages=!1;this.startPage=b.startPage;this.onShowPage=b.onShowPage;this.slideShow=b.slideShow;this.slideShowDelay=b.slideShowDelay;this.pauseOnHover=b.pauseOnHover;this.turnPageDuration=b.turnPageDuration;this.foldGradient=b.foldGradient;this.foldGradientThreshold=b.foldGradientThreshold;this.shadows=
b.shadows;this.shadowThreshold=b.shadowThreshold;this.clipBoundaries=b.clipBoundaries;this.zoomLevel=b.zoomLevel;this.zoomMax=b.zoomMax;this.zoomBoundingBox=b.zoomBoundingBox;this.zoomStep=b.zoomStep;this.onZoom=b.onZoom;this.mouseWheel=b.mouseWheel;this.flipSound=b.flipSound;this.centeredWhenClosed=b.centeredWhenClosed;this.sectionDefinition=b.sections;d.support.filters="filters"in a[0];var f=this.pageWidth,e=this.pageHeight;a.addClass("wowbook");"static"===a.css("position")&&a.css("position","relative");
a.css({height:b.height,width:b.width});var g=a.children(),h=this.pagesContainer=this.origin=d("<div class='wowbook-origin'></div>").css({position:"absolute",width:"100%",height:a.height()}).appendTo(a);c.bookShadow=d("<div class='wowbook-book-shadow'></div>").appendTo(a).css({width:b.width,height:b.height,top:0,position:"absolute",display:"none",zIndex:0});this.insertPages(g,!0);h.append("<div class='wowbook-shadow-clipper'><div class='wowbook-shadow-container'><div class='wowbook-shadow-internal'></div></div></div>");
c.shadowContainer=d(".wowbook-shadow-container",h);c.internalShadow=d(".wowbook-shadow-internal",h);c.shadowClipper=d(".wowbook-shadow-clipper",h).css({display:"none",width:a.width(),height:a.height()});c.foldShadow=d("<div class='wowbook-shadow-fold'></div>").appendTo(c.shadowContainer);c.foldGradientContainer=d("<div class='wowbook-fold-gradient-container'></div>").appendTo(c.shadowContainer);c.foldGradientElem=d("<div class='wowbook-fold-gradient'></div>").appendTo(c.foldGradientContainer);c.hardPageShadow=
d("<div class='wowbook-hard-page-shadow'></div>").css({display:"none",width:f,height:e}).appendTo(h);!d.support.opacity&&d.support.filters&&d.wowBook.applyAlphaImageLoader(["wowbook-fold-gradient","wowbook-fold-gradient-flipped","wowbook-shadow-fold","wowbook-shadow-fold-flipped"]);c.shadowContainer.css("position","relative");this.leftHandle=d("<div class='wowbook-handle wowbook-left'></div>").data("corner","l").appendTo(h);this.rightHandle=d("<div class='wowbook-handle wowbook-right'></div>").data("corner",
"r").appendTo(h);b.handleWidth&&d(".wowbook-handle",h).css("width",b.handleWidth);this.rightHandle.css("left",b.width-this.rightHandle.width());d.browser.msie&&d(".wowbook-handle",a).css({backgroundColor:"#fff",filter:"alpha(opacity=1)"});d(".wowbook-handle",h).bind("mousedown",function(a){return c.pageEdgeDragStart(a)});var i;d(".wowbook-handle",h).mousedown(function(){i=d.now()}).mouseup(function(){if(!((new Date).getTime()-i>c.opts.handleClickDuration)){var a=d(this).data("corner");"r"===a&&c.advance();
"l"===a&&c.back()}});var l=!1;a.hover(function(){if(c.pauseOnHover){l=c.slideShowTimer;var a=d(c.opts.controls.slideShow),b=a.hasClass("wowbook-disabled");c.stopSlideShow();a.toggleClass("wowbook-disabled",b)}},function(){c.pauseOnHover&&l&&c.startSlideShow()});this.clipBoundaries&&(g=Math.sqrt(f*f+e*e),g=[e-g,a.width(),g,0],this.origin.wrap("<div class='wowbook-clipper'><div class='wowbook-inner-clipper'></div></div>").css("top",-g[0]),d(".wowbook-inner-clipper",a).css({position:"absolute",width:"100%",
height:g[2]-g[0],top:g[0],overflow:"hidden"}),this.clipper=d(".wowbook-clipper",a).css({position:"absolute",left:0,top:0,width:"100%",height:a.height(),overflow:"hidden",zIndex:1}));a.wrapInner("<div class='wowbook-zoomwindow'><div class='wowbook-zoomcontent'></div></div>");this.zoomWindow=d(".wowbook-zoomwindow",a);this.zoomContent=d(".wowbook-zoomcontent",a);d.browser.ie8&&this.zoomContent.wrapInner("<div class='IE8-zoom-helper'style='position:relative'></div>");this.zoomWindow.css({position:"absolute",
width:2*f,height:a.height(),top:0});this.zoomContent.css({position:"absolute",width:2*f,height:a.height(),left:0,top:0});this.fillToc();b.deepLinking&&this.getLocationHash()&&(g=c.selectorToPage("#"+this.getLocationHash()),void 0===g&&(g=c.locationHashToPage()),"number"===typeof g&&(c.startPage=g,t(c.elem)||c.elem[0].scrollIntoView()));this.showPage(this.startPage,!1);this.corners={tl:[0,0],bl:[0,e],tr:[f,0],br:[f,e],l:[0,0],r:[f,0]};this.audio=this.createAudioPlayer();this.opts.keyboardNavigation&&
d(document).keydown(function(a){if(!d(a.target).filter("input, textarea, select").length){a.which===c.opts.keyboardNavigation.back&&c.back();a.which===c.opts.keyboardNavigation.advance&&c.advance()}});d(window).hashchange(function(){var a=window.location.hash;if(a===c.locationHashSetTo)c.locationHashSetTo=void 0;else{var b=(a=a===""&&!c.locationEndsInHash())?c.startPage:c.locationHashToPage();if(typeof b==="number"){c.gotoPage(b,!a);!a&&!t(c.elem)&&c.elem[0].scrollIntoView()}}});b.forceBasicPage&&
(this.foldPage=this.holdHardpage=this.foldPageBasic);d.support.transform||(this.foldPage=this.foldPageBasic,d.support.filters||(this.holdHardpage=this.foldPageBasic));this.mouseWheel&&a.mousewheel(function(a,b){if(c.mouseWheel){if(c.mouseWheel==="zoom"){b>0&&c.zoomIn();b<0&&c.zoomOut();c.zoomedAt(a)}else{b>0&&c.advance();b<0&&c.back()}return false}});this.touchSupport();this.controllify(this.opts.controls);b.slideShow&&this.startSlideShow()}function r(a,b){var c=Math.cos(b),f=Math.sin(b);return{x:c*
a.x-f*a.y,y:f*a.x+c*a.y}}function t(a){var b=d(window).height(),c=a.offset(),f=d(window).scrollTop();return c.top>f&&c.top+a.height()<f+b}function j(a,b,c){var f,e,g,h;f=e=0;if(!d.support.boxSizing){var i;f="none"==a.css("borderTopStyle")?0:o[i=a.css("borderTopWidth")]||parseFloat(i);e="none"==a.css("borderRightStyle")?0:o[i=a.css("borderRightWidth")]||parseFloat(i);g="none"==a.css("borderBottomStyle")?0:o[i=a.css("borderBottomWidth")]||parseFloat(i);h="none"==a.css("borderLeftStyle")?0:o[i=a.css("borderLeftWidth")]||
parseFloat(i);e=parseFloat(a.css("paddingLeft"))+parseFloat(a.css("paddingRight"))+h+e;f=parseFloat(a.css("paddingTop"))+parseFloat(a.css("paddingBottom"))+f+g}a.css("width",b-e);a.css("height",c-f)}d.wowBook=function(a){return d(a).data("wowBook")};d.fn.wowBook=function(a){if("string"===typeof a){var b=Array.prototype.slice.call(arguments,1);if("options"===a||"prop"===a){var c=d.wowBook(this[0]),f=b[0];return 1<b.length?c[f]=b[1]:c[f]}return this.each(function(){var c=d.wowBook(this);c[a].apply(c,
b)})}var e=d.extend({},d.wowBook.defaults,a);return this.each(function(){var a=new q(this,e);d(this).data("wowBook",a)})};q.prototype={insertPages:function(a,b){for(var c=0,f=a.length;c<f;c++)this.insertPage(a[c],!0);this.updateBook(b)},insertPage:function(a,b){var a=d(a).addClass("wowbook-page-content"),c=d("<div class='wowbook-page'></div>").css({width:this.pageWidth,height:this.pageHeight,display:"none",position:"absolute"}).appendTo(this.pagesContainer).append(a);d.support.boxSizing&&a.css(d.support.boxSizing,
"border-box");j(a,this.pageWidth,this.pageHeight);c.hardPageSetByUser=a.hasClass("wowbook-hardpage");this.opts.gutterShadow&&d("<div class='wowbook-gutter-shadow'></div>").appendTo(a).css("height",this.pageHeight);this.pages.push(c);b||this.updateBook();return c},removePages:function(a,b){arguments.length||(a=0,b=-1);this.holdedPage&&this.releasePage(this.holdedPage);var c=this.pages,b=(b||a)+1||c.length,f=c.slice(a,b),e=c.slice(b);c.length=0>a?c.length+a:a;c.push.apply(c,e);for(var e=0,d=f.length;e<
d;e++)f[e].remove();this.updateBook();return c.length},updateBook:function(a){this.doPageNumbering();this.findPagesType();this.positionBookShadow();for(var b=!1,c,f=0,e=this.pages.length;f<e;f++)c=this.pages[f].toggleClass("wowbook-left",b).toggleClass("wowbook-right",!b).data({pageIndex:f,holded:!1}),c.pageIndex=f,b=!b;this.findSections();a||this.showPage(this.currentPage)},doPageNumbering:function(){var a=this.opts;if(a.pageNumbers){var b=a.numberedPages,a=this.pages.length-1,c=this.pageIsOnTheLeft(a);
"all"==b&&(b=[0,-1]);b||(b=[2,c?-3:-2]);var f=b[0],b=b[1];0>f&&(f=a+f+1);0>f&&(f=0);f>this.pages.length-1&&(f=a);0>b&&(b=a+b+1);0>b&&(b=0);b>this.pages.length-1&&(b=a);for(var e=this.opts.firstPageNumber,c=0;c<f;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=b+1;c<a;c++)d(".wowbook-page-number",this.pages[c]).remove();for(c=f;c<=b;c++)a=d(".wowbook-page-number",this.pages[c]),a.length||(a=d(".wowbook-page-content",this.pages[c]),a=d('<div class="wowbook-page-number"></div>').appendTo(a)),
a.html(e++)}},findPagesType:function(){var a=this.opts,b={},c,f,e;e=a.hardPages||[];var d=!0===e;if(!d){a.hardcovers&&(e.push(0,1,-1),this.pageIsOnTheLeft(this.pages.length-1)&&e.push(-2));a=0;for(f=e.length;a<f;a++)c=e[a],0>c&&(c=this.pages.length+c),0<=c&&c<this.pages.length&&(b[c]=!0)}for(a=this.pages.length;a--;)e=d||b[a]||this.pages[a].hardPageSetByUser,this.pages[a].toggleClass("wowbook-hardpage",e).isHardPage=e},showPage:function(a,b){0>a&&(a=0);a>this.pages.length-1&&(a=this.pages.length-
1);this.currentPage=a;for(var c=a-(1-a%2),f=c+1,e=this.pageWidth,g=!1,h,i,l=0,j=this.pages.length;l<j;l++)h=g?l:j-l,i=this.transparentPages?g?l<=c?"block":"none":l>=f?"block":"none":l===c-2||l===c||l===f||l===f+2?"block":"none",this.pages[l].data("zIndex",h).css({display:i,left:g?0:e,top:0,zIndex:h}),g=!g;c=0<a;f=this.rightPage();this.leftHandle.toggleClass("wowbook-disabled",!c);this.rightHandle.toggleClass("wowbook-disabled",!(f&&this.backPage(f.pageIndex)));d(this.opts.controls.back).toggleClass("wowbook-disabled",
!c);d(this.opts.controls.next).toggleClass("wowbook-disabled",!(f&&this.backPage(f.pageIndex)));if((g=this.onShowPage)&&d.isFunction(g))g(this,this.pages[a],a),(h=this.otherPage(a))&&g(this,this.pages[h],h);this.opts.centeredWhenClosed&&this.origin.css("left",c&&f?0:c?e/2:-e/2);this.positionBookShadow();!1!==b&&(this.opts.updateBrowserURL&&this.locationHashToPage()!=a)&&(this.locationHashSetTo=window.location.hash=this.pageToLocationHash(a))},holdPage:function(a,b,c,f,e){"number"===typeof a&&(a=this.pages[a]);
if(a){var d=a.data("pageIndex"),h=this.pages.length-1,i=this.pageIsOnTheLeft(h);if(f){if(!this.corners[f]||(this.pageIsOnTheLeft(d)?/r/:/l/).test(f))return}else f=this.pageIsOnTheLeft(d)?"l":"r";void 0===e&&(e=this.backPage(d));if(e){var l=e.data("pageIndex");if(this.centeredWhenClosed&&(0===d||0===l||i&&(l===h||d===h))){var j=0,k,m=this.pageWidth,p,n,s,o,r,q,t,v;0===d&&(p=-m/2,n=-m/4,s=0,o=-m/2,r=-m,q=n,t=r,v=b);d===h&&i&&(p=m,n=3*m/2,s=m/2,o=0,r=m,q=2*m,t=b,v=q);0===l&&(p=m/2,n=d===h?m:3*m/2,s=
d===h?m/2:0,o=-m/2,r=p,q=2*m,t=b,v=q);l===h&&i&&(p=0===d?0:-m/2,n=m/2,s=m/2,o=0===d?-m/2:0,r=-m,q=n,t=r,v=b);b<p&&(j=s,k=t);b>n&&(j=o,k=v);b>=p&&b<=n&&(b=(b-p)/(n-p),j=s+b*(o-s),k=r+b*(q-r));b=k;this.origin.css("left",j);this.positionBookShadow()}this.zoomed||"basic"==this.pageType(a)||"basic"==this.pageType(e)?this.foldPageBasic(a,b,c,f,e):a.isHardPage||e.isHardPage?this.holdHardpage(a,b,c,f,e):this.foldPage(a,b,c,f,e);if(!a.data("holded")&&(a.addClass("wowbook-page-holded"),e.addClass("wowbook-page-holded"),
a.data("holded",!0),this.holdedPage=a,this.holdedPageBack=e,this.shadows&&this.shadowClipper.css("display","block"),this.clipBoundaries&&this.clipper.css("overflow","visible"),this.positionBookShadow(),this.opts.onHoldPage))this.opts.onHoldPage(this,d,a,e)}}},foldPage:function(a,b,c,f,d){"number"===typeof a&&(a=this.pages[a]);var g=a.data("pageIndex");void 0===d&&(d=this.backPage(g));if(d&&d.length){var h=a.children().first(),g=d.children().first(),i=this.pageWidth,l=this.pageHeight,j=i/2,k=l/2;f||
(f="tl");if("l"==f||"r"==f){var m=a.data("grabPoint");m||(m={x:"l"==f?0:i,y:c},a.data("grabPoint",m));var f=(c>=m.y?"t":"b")+f,p=b-m.x,n=c-m.y,p=Math.atan2(n,p),m={x:0,y:(c>=m.y?0:l)-m.y},m=r(m,2*p),b=m.x+b,c=m.y+c}a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",f);d.css("left",a.css("left"));m=this.corners[f];f=i-m[0];fy=m[1];var p=b-f,n=c-fy,s=Math.sqrt(p*p+n*n);s>i&&(b=f+i*p/s,c=fy+i*n/s);fy=l-fy;p=b-f;n=c-fy;s=Math.sqrt(p*p+n*n);maxdistance=Math.sqrt(i*i+l*l);s>maxdistance&&(b=f+maxdistance*
p/s,c=fy+maxdistance*n/s);f=m[0];m=m[1];if(f==b&&m==c)this.releasePage(a);else{m==c&&(c=m+0.001);p=b-f;n=c-m;s=Math.sqrt(p*p+n*n);b=s/2;p=Math.atan2(n,p);n=Math.tan(p);c=p;p=180*p/Math.PI;h.css("transform","rotate("+-p+"deg)");var h={x:f-j,y:k-m},s=r(h,c),o=s.x+b+j;a.css({clip:"rect(-1000px 1000px 1000px "+o+"px)",transform:"rotate("+p+"deg)"});s=this.calculateOpacity(b,i,this.shadowThreshold,50);if(this.shadows&&0<s){var q=2*Math.sqrt(i*i+l*l),t=-(q-l)/2,x=o+parseFloat(a.css("left"));this.internalShadow.css({display:"block",
height:q,transform:"translate("+x+"px,"+t+"px) rotate("+p+"deg)",transformOrigin:j-o+"px "+(k+(q-l)/2)+"px"});o-=this.foldShadow.width();this.foldShadow.css({display:"block",height:q,transform:"translate("+(o+parseFloat(a.css("left")))+"px,"+t+"px) rotate("+p+"deg)",transformOrigin:j-o+"px "+(k+(q-l)/2)+"px"});this.shadowContainer.css({opacity:s,display:"block"})}else this.shadowContainer.hide();d.show();g.css("transform","rotate("+p+"deg)");h.x=-h.x;s=r(h,-c);o=s.x-b+j;d.css({clip:"rect(-1000px 1000px 1000px "+
o+"px)",zIndex:1E3,transform:"rotate("+p+"deg)"});a={x:s.x-b,y:s.y+b*n};h={x:s.x-b,y:s.y-b/(0==n?1.0E-4:n)};a=r(a,-c);h=r(h,-c);h=-(h.x+j);a=-(a.y-k);d.css({marginLeft:f+h,marginTop:m-a});s=this.calculateOpacity(2*b,2*i,this.foldGradientThreshold,50);this.foldGradient&&0<s?(d=2*Math.sqrt(i*i+l*l),this.foldGradientContainer.appendTo(g),this.foldGradientContainer.css({opacity:s,position:"absolute",left:i-f-this.foldGradientElem.width()/2,top:m-d/2,width:this.foldGradientElem.width(),height:d,transform:"rotate("+
-p+"deg)"}),this.foldGradientElem.css({left:-b+this.foldGradientElem.width()/2,height:d}),this.foldGradientContainer.show()):this.foldGradientContainer.hide()}}},holdHardpage:function(a,b,c,f,e){"number"===typeof a&&(a=this.pages[a]);var g=a.data("pageIndex"),h=this.pageIsOnTheRight(g),i=this.pageWidth,l=this.pageHeight;void 0===e&&(e=this.backPage(g));e&&e.length&&(f||(f="tl"),a.data("holdedAt",{x:b,y:c}),a.data("holdedCorner",f),c=h?i-b:b,f=h?0:i,0>c&&(c=0),c=(g=c<i)?a:e,(g?e:a).css("display","none"),
a=h!=g,b-=f,b>i&&(b=i),b<-i&&(b=-i),h=-Math.sqrt(1600*(1-b*b/((i+15)*(i+15)))),e=Math.abs(b/i),h=1==e?0:Math.atan2(h,b),this.opts.use3d&&Modernizr.csstransforms3d?(f=g?f:i-f,roty=a?-this._calculateAngleFromX(-b,i,this.opts.perspective):this._calculateAngleFromX(b,i,this.opts.perspective),c.css(Modernizr.prefixed("perspectiveOrigin"),"0 50%"),c.css({transform:"perspective("+this.opts.perspective+"px) rotate3d(0, 1, 0, "+roty+"deg)",transformOrigin:f+"px 50%",display:"block",zIndex:1E3})):c.css({transform:"skewY("+
h+"rad) scaleX("+e+")",transformOrigin:(g?f:i-f)+"px 50%",display:"block",zIndex:1E3}),!d.support.transform&&d.support.filters&&(f="M11="+e+", M12=0, M21="+Math.tan(h)*e+", M22=1",c.css("filter","progid:DXImageTransform.Microsoft.Matrix("+f+", sizingMethod='auto expand')"),c.css({marginTop:l-c.height(),marginLeft:a?i-c.width():0})),this.shadows&&this.hardPageShadow.css({display:"block",left:a?0:i,opacity:0.5*Math.abs(b/i)}))},_calculateAngleFromX:function(a,b,c){var d=180/Math.PI,e=b*b,c=c*c,g=a*
a;angle=Math.acos((b*c*a-Math.sqrt(e*e*c*g+e*e*g*g-e*c*g*g))/(e*c+e*g));return angle=-angle*d},foldPageBasic:function(a,b,c,d,e){"number"===typeof a&&(a=this.pages[a]);var g=a.data("pageIndex"),h=this.pageIsOnTheRight(g),i=!h;void 0===e&&(e=this.backPage(g));if(e&&e.length){var g=this.pageWidth,l=this.pageHeight,j=this.foldGradientElem.width(),k=this.foldShadow.width();d||(d="tl");a.data("foldPageBasic")||(a.data("foldPageBasic",!0),this.internalShadow.css("display","none"),this.foldShadow.css({display:"none",
height:l,transform:"",top:0}).toggleClass("wowbook-shadow-fold-flipped",h),this.shadowContainer.css("display","block"),this.foldGradientContainer.appendTo(e.children().first()).css({width:j,height:l,top:0,transform:"",zIndex:1E9}),this.foldGradientElem.css({left:0,height:l}).toggleClass("wowbook-fold-gradient-flipped",h));a.data("holdedAt",{x:b,y:c});a.data("holdedCorner",d);h=i?b:g-b;0>h&&(h=0);h>2*g&&(h=2*g);b=h/2;i?(c="rect(-1000px 1000px 1000px "+b+"px)",d="rect(-1000px 1000px 1000px "+(g-b)+
"px)",h-=g):(c="rect(-1000px "+(g-b)+"px 1000px -1000px)",d="rect(-1000px "+b+"px 1000px -1000px)",h=g-h+g);a.css("clip",c);e.css({clip:d,left:h,zIndex:1E3,display:"block"});a=this.calculateOpacity(2*b,2*g,this.shadowThreshold,50);this.shadows&&0<a?(e=i?b-k:g-b+g,this.shadowContainer.css("opacity",a),this.foldShadow.css({left:e,display:"block"})):this.foldShadow.css("display","none");a=this.calculateOpacity(2*b,2*g,this.foldGradientThreshold,50);this.foldGradient&&0<a?this.foldGradientContainer.css({opacity:a,
left:i?g-b:b-j,display:"block"}):this.foldGradientContainer.css("display","none")}},animateFoldPage:function(a,b,c,f,e,g,h){var i=this;if(!i.animating){i.animating=!0;c||(c=a.data("holdedAt"));b||(b=a.data("holdedCorner"));var l=c.x-f.x,j=c.y-f.y,f=this.turnPageDuration*Math.abs(l)/(2*this.pageWidth),k,m;!a.isHardPage&&0.4<f/this.turnPageDuration&&this.playFlipSound();this.holdPage(a,c.x,c.y,b,h);this._percent=0;d(this).animate({_percent:1},{duration:f,easing:"linear",complete:function(){i.animating=
!1;d.isFunction(e)&&e()},step:function(d){k=c.x-d*l;m=c.y-d*j;g&&(m-=(0.5-Math.abs(0.5-d))*i.pageHeight/10);i.holdPage(a,k,m,b,h)}})}},stopAnimation:function(){d(this).stop(!0,!0)},releasePages:function(){for(var a=0,b=this.pages.length;a<b;a++)this.pages[a].data("holded")&&this.releasePage(a)},releasePage:function(a,b,c){"number"===typeof a&&(a=this.pages[a]);var d=this,e=a.data("holdedAt"),g=a.data("holdedCorner");if(b&&e)this.animateFoldPage(a,g,e,{x:this.corners[g][0],y:this.corners[g][1]},function(){d.releasePage(a,
!1,c)},!1,c);else if(b=a.data("pageIndex"),void 0===c&&(c=this.holdedPageBack||this.backPage(b)),this.holdedPageBack=this.holdedPage=null,a.data({holdedAt:null,holdedCorner:null,grabPoint:!1,foldPageBasic:null,holded:!1}),this.clipBoundaries&&!this.zoomed&&this.clipper.css("overflow","hidden"),this.shadowClipper.css("display","none"),this.internalShadow.parent().hide(),this.foldGradientContainer.hide(),this.hardPageShadow.hide(),this.resetPage(a),c&&c.length&&(this.resetPage(c),c.hide()),this.foldShadow.removeClass("wowbook-shadow-fold-flipped").css({transform:"",
left:""}),this.foldGradientElem.removeClass("wowbook-fold-gradient-flipped").css("transform",""),this.foldGradientContainer.css("transform","").appendTo(this.pagesContainer),this.positionBookShadow(),this.opts.onReleasePage)this.opts.onReleasePage(this,b,a,c)},resetPage:function(a){a.removeClass("wowbook-page-holded");this.resetCSS||(this.resetCSS={transform:"",transformOrigin:"",clip:"auto",marginLeft:0,marginTop:0,filter:""});var b=this.pageWidth,c=this.pageHeight;a.css(this.resetCSS).css({zIndex:a.data("zIndex"),
width:b,height:c,left:this.pageIsOnTheLeft(a.data("pageIndex"))?0:b});d.browser.msie&&9>d.browser.version&&a.attr("style",a.attr("style").replace(/clip\: [^;]+;/i,""));a=d(".wowbook-page-content",a);a.css(this.resetCSS);j(a,b,c)},gotoPage:function(a,b){if(!this.animating&&("string"===typeof a&&"#"==a[0]&&(a=this.selectorToPage(a)),0>a&&(a=0),a>this.pages.length-1&&(a=this.pages.length-1),!this.isOnPage(a))){var c=a<this.currentPage,d=this,e=c?d.leftPage():d.rightPage();if(e){var g,h;c?(g=this.leftPage(a),
h=this.rightPage(a)):(g=this.rightPage(a),h=this.leftPage(a));if(c)for(var i=e.pageIndex-1;0<=i;i--)this.pages[i].css("display","none");else for(var i=e.pageIndex+1,j=this.pages.length;i<j;i++)this.pages[i].css("display","none");g&&g.css("display","block");var k=a;g=e.data("holdedAt");i=e.data("holdedAt");j=e.data("holdedCorner")||(c?"tl":"tr");c?(i=i||{x:0,y:0},c={x:2*d.pageWidth,y:"bl"!=j?0:this.pageHeight}):(i=i||{x:this.pageWidth,y:0},c={x:-d.pageWidth,y:"br"!=j?0:this.pageHeight});d.animateFoldPage(e,
j,i,c,function(){d.releasePage(e,false,h);d.showPage(k,b)},!g,h);return a}}},back:function(){return this.gotoPage(this.currentPage-2)},advance:function(){return this.gotoPage(this.currentPage+2)},leftPage:function(a){a=void 0!==a?a:this.currentPage;this.pageIsOnTheRight(a)&&a--;return this.pages[a]||null},rightPage:function(a){a=void 0!==a?a:this.currentPage;this.pageIsOnTheLeft(a)&&a++;return this.pages[a]||null},pageIsOnTheRight:function(a){return!(a%2)},pageIsOnTheLeft:function(a){return!!(a%2)},
otherPage:function(a){a+=this.pageIsOnTheRight(a)?-1:1;if(0>a||a>this.pages.length-1)a=null;return a},isOnPage:function(a){return"number"===typeof a&&(a===this.currentPage||a===this.otherPage(this.currentPage))},backPage:function(a){return this.pages[a+(this.pageIsOnTheRight(a)?1:-1)]},pageType:function(a){a="number"===typeof a?this.pages[a]:a;return a.isHardPage?"hard":a.find(".wowbook-page-content.wowbook-basic-page").length?"basic":"soft"},calculateOpacity:function(a,b,c,d){if(a<=c||a>=b-c)return 0;
if(a>=d&&a<=b-d)return 1;a>d&&(a=b-a);return(a-c)/(d-c)},startSlideShow:function(){this.slideShowRunning=!0;this.advanceAfterTimeout(this.slideShowDelay);d(this.opts.controls.slideShow).addClass("wowbook-disabled")},advanceAfterTimeout:function(a){var b=this;this.slideShowTimer=setTimeout(function(){b.animating||b.holdedPage?b.advanceAfterTimeout(100):(b.advance(),b.isOnPage(b.pages.length-1)?b.stopSlideShow():b.advanceAfterTimeout(b.slideShowDelay+b.turnPageDuration))},a)},stopSlideShow:function(){clearTimeout(this.slideShowTimer);
this.slideShowTimer=void 0;this.slideShowRunning=!1;d(this.opts.controls.slideShow).removeClass("wowbook-disabled")},toggleSlideShow:function(){this.slideShowRunning?this.stopSlideShow():this.startSlideShow()},findSections:function(a){a&&(this.sectionDefinition=a);var b=this.sectionDefinition,a=[],c;"string"===typeof b&&(c=b,b=[],d(c,this.elem).each(function(a,c){b.push(["#"+c.id,d(c).html()])}));if(d.isArray(b)){for(var f=0,e=b.length;f<e;f++){c=b[f];if("string"===typeof c)try{c=[c,d(c,this.elem).html()]}catch(g){this.log("Something wrong happened at the function 'findSections' (maybe you have passed a invalid jquery selector?) :<br/>&nbsp;&nbsp;"+
g);continue}try{c[2]=this.selectorToPage(c[0])}catch(h){this.log("Something wrong happened at the function 'findSections' (maybe you have passed a invalid jquery selector?) :<br/>&nbsp;&nbsp;"+h);continue}void 0!==c[2]&&a.push({id:c[0],title:c[1],page:c[2]})}a=a.sort(function(a,b){return a.page-b.page})}return this.sections=a},pageToSection:function(a){for(var b=this.sections,c,d=0,e=b.length;d<e&&!(b[d].page>a);d++)c=b[d];return c},currentSection:function(){return this.pageToSection(this.currentPage)},
fillToc:function(a,b){var c=d(a||this.opts.toc),f,e,g="";if(0!==c.length){f=this.sections;"undefined"===typeof b&&(b=this.opts.tocTemplate);b||(g=c.is("UL, OL")?"<li>":"<div>",b='<a href="${link}">${section}</a>');for(var h=0,i=f.length;h<i;h++)e=f[h],e=b.replace(/\$\{link\}/g,"#"+this.id+"/"+e.id.substr(1)).replace(/\$\{section\}/g,e.title).replace(/\$\{page\}/g,e.page),d(e).appendTo(c).wrap(g)}},locationHashToPage:function(a){void 0===a&&(a=window.location.hash);if(a=="#"+this.id+"/")return 0;a=
a.slice(1).split("/");if(a[0]===this.id){if(1===a.length)return 0;var b=parseInt(a[1]);if(!isNaN(b))return Math.max(b-1,0);b=this.selectorToPage("#"+a[1]);if(void 0===b)return 0;isNaN(a[2])||(b+=Math.max(parseInt(a[2])-1,0));return+b}},pageToLocationHash:function(a){var b="",c=a+1;if(a=this.pageToSection(a))b+="/"+a.id.replace("#",""),c-=a.page;1<c&&(b+="/"+c);return"#"+this.id+(b||"/")},selectorToPage:function(a){a=d(a,this.elem).closest(".wowbook-page");if(a.length)return+a.data("pageIndex")},getLocationHash:function(){return window.location.hash.slice(1)},
locationEndsInHash:function(a){void 0===a&&(a=window.location.href);return a.lastIndexOf("#")==a.length-1},zoom:function(a){for(var b=0,c=this.pages.length;b<c;b++)if(this.pages[b].data("holdedAt"))return;1>a&&(a=1);a>this.zoomMax&&(a=this.zoomMax);if(a!==this.zoomLevel){this.zoomLevel=a;var f=this,b=this.zoomWindow,c=this.zoomContent,e=d(this.zoomBoundingBox),g=a,h=2*f.pageWidth*g,g=f.pageHeight*g,i=e.width(),j=e.height(),k=Math.min(h,i),o=Math.min(g,j),m=(this.opts.width-k)/2,p=(this.opts.height-
o)/2;b.css({width:k,height:o,left:m,top:p});this.zoomContentOverflowed=h>i||g>j;var n=b.offset(),e=e[0]!==window?e.offset():{left:e.scrollLeft(),top:e.scrollTop()};n.right=n.left+k;n.bottom=n.top+o;e.right=e.left+i;e.bottom=e.top+j;n.left<e.left&&b.css("left",m+(e.left-n.left));n.right>e.right&&b.css("left",m+(e.right-n.right));n.top<e.top&&b.css("top",p+(e.top-n.top));n.bottom>e.bottom&&b.css("top",p+(e.bottom-n.bottom));n=b.offset();e=c.offset();n.right=n.left+k;n.bottom=n.top+o;e.right=e.left+
h;e.bottom=e.top+g;e.left>n.left&&c.css("marginLeft",0);e.right<n.right&&c.css("marginLeft",(parseFloat(c.css("marginLeft"))||0)+(n.right-e.right));e.top>n.top&&c.css("marginTop",0);e.bottom<n.bottom&&c.css("marginTop",(parseFloat(c.css("marginTop"))||0)+(n.bottom-e.bottom));k===h&&c.css("marginLeft",0);o===g&&c.css("marginTop",0);d.support.transform?c.css({transform:"scale("+a+")",transformOrigin:"0 0"}):c.css("zoom",a);1===this.zoomLevel?(b.unbind("mousemove.wowbook").css({overflow:"visible",left:0,
top:0}),this.clipBoundaries&&this.clipper.css("overflow","hidden"),c.css({marginLeft:0,marginTop:0})):(this.clipBoundaries&&this.clipper.css("overflow","visible"),b.css("overflow","hidden"),this.zoomed||b.bind("mousemove.wowbook",function(a){f.zoomedAt(a)}));this.zoomed=1!==a;this.positionBookShadow();if(this.onZoom)this.onZoom(this)}},zoomIn:function(a){this.zoom(this.zoomLevel+(a||this.zoomStep))},zoomOut:function(a){this.zoom(this.zoomLevel-(a||this.zoomStep))},zoomedAt:function(a){if(this.zoomContentOverflowed){var b=
this.zoomLevel,c=this.zoomWindow.offset(),f=a.pageX-c.left,a=a.pageY-c.top,e=this.zoomWindow.width(),c=2*this.pageWidth*b-e,f=f/e,e=this.zoomWindow.height(),g=this.pageHeight*b-e;adjust=d.browser.ie8?b:1;this.zoomContent.css({marginLeft:-c*f/adjust,marginTop:-g*(a/e)/adjust})}},positionBookShadow:function(){var a=this.pages.length,b=!(!this.opts.bookShadow||this.zoomed||!a||3>a&&this.holdedPage);this.bookShadow.toggle(b);if(b){var b=this.pageWidth,c=this.currentPage,d=this.holdedPageBack&&this.holdedPageBack.pageIndex,
e=d&&this.pageIsOnTheLeft(d),c=0<c,g=this.rightPage(),c=!c||0===d,a=!g||d===a-1&&e,d=c!=a;c&&a?this.bookShadow.hide():this.bookShadow.css({left:(c?b:0)+this.pagesContainer.position().left,width:d?b:2*b})}},playFlipSound:function(){if(this.flipSound){var a=this.opts.onPlayFlipSound;d.isFunction(a)&&!1===a(this)||this.audio&&this.audio.play&&this.audio.play()}},createAudioPlayer:function(a,b){a||(a=this.opts.flipSoundPath);b||(b=this.opts.flipSoundFile);for(var c=[],f=0,e=b.length;f<e;f++)c.push('<source src="'+
a+b[f]+'">');return d("<audio preload>"+c.join("")+"</audio>")[0]},_untouch:function(a){return a.originalEvent.touches&&a.originalEvent.touches[0]||a},touchSupport:function(){var a=this;a.elem.bind("touchstart",function(b){var c=b.originalEvent.touches;1<c.length||(a._touchStarted={x:c[0].pageX,y:c[0].pageY,timestamp:b.originalEvent.timeStamp,inHandle:d(b.target).hasClass("wowbook-handle")},a._touchStarted.inHandle&&a.pageEdgeDragStart(a._untouch(b)))});d(document).bind("touchmove",function(b){if(a._touchStarted){var c=
b.originalEvent.touches;a._touchEnded={x:c[0].pageX,y:c[0].pageY,timestamp:b.originalEvent.timeStamp};if(a._touchStarted.inHandle)return a.pageEdgeDrag(a._untouch(b));20<Math.abs(a._touchEnded.x-a._touchStarted.x)&&b.preventDefault();b.preventDefault()}});d(document).bind("touchend touchcancel",function(){if(a._touchStarted){var b=a._touchStarted;a._touchStarted=null;if(b.inHandle)return a.pageEdgeDragStop({pageX:a._touchEnded.x});var c=a._touchEnded.x-b.x,d=a._touchEnded.y-b.y,b=a._touchEnded.timestamp-
b.timestamp;if(!(20>Math.abs(c)||200<b)&&Math.abs(c)>Math.abs(d))return 0>c?a.advance():a.back(),!1}})},pageEdgeDragStart:function(a){if(this.animating||this.zoomed||!d(a.target).hasClass("wowbook-handle"))return!1;var b=this,c=b.elem.offset();b.mouseDownAtLeft=a.pageX-c.left<b.pageWidth;b.pageGrabbed=b.mouseDownAtLeft?b.leftPage():b.rightPage();if(!b.pageGrabbed)return!1;b.pageGrabbedOffset=b.pageGrabbed.offset();d(document).bind("mousemove.wowbook",function(a){return b.pageEdgeDrag(a)}).bind("mouseup.wowbook",
function(a){return b.pageEdgeDragStop(a)});return!1},pageEdgeDrag:function(a){this.holdPage(this.pageGrabbed,a.pageX-this.pageGrabbedOffset.left,a.pageY-this.pageGrabbedOffset.top);return!1},pageEdgeDragStop:function(a){var b=this.elem.offset(),a=a.pageX-b.left<this.pageWidth;this.mouseDownAtLeft&&!a?this.back():!this.mouseDownAtLeft&&a?this.advance():this.releasePage(this.pageGrabbed,!0);d(document).unbind(".wowbook")},controllify:function(a){var b=this;d(a.zoomIn).click(function(){b.zoomIn();return!1});
d(a.zoomOut).click(function(){b.zoomOut();return!1});d(a.next).click(function(){b.advance();return!1});d(a.back).click(function(){b.back();return!1});d(a.first).click(function(){b.gotoPage(0);return!1});d(a.last).click(function(){b.gotoPage(b.pages.length-1);return!1});d(a.slideShow).click(function(){b.toggleSlideShow();return!1})},log:function(a){if(this.opts.debug){var b=d("#wowbook_log");b.length||(b=d("<div/>",{id:"wowbook_log",style:"position: absolute; top:0; left:0; background: #F8F800; color:black; padding:1em;"}).appendTo("body"));
d("<div>",{html:a}).appendTo(b)}}};d.wowBook.defaults={width:500,height:300,startPage:0,hardcovers:!1,hardPages:!1,centeredWhenClosed:!1,transparentPages:!1,use3d:!0,perspective:2E3,bookShadow:!0,gutterShadow:!0,shadowThreshold:20,shadows:!0,foldGradient:!0,foldGradientThreshold:20,pageNumbers:!0,firstPageNumber:1,numberedPages:!1,deepLinking:!0,updateBrowserURL:!0,slideShow:!1,slideShowDelay:1E3,pauseOnHover:!0,mouseWheel:!1,handleWidth:!1,handleClickDuration:300,turnPageDuration:1E3,forceBasicPage:!1,
sections:".wowbook-section",zoomLevel:1,zoomMax:2,zoomBoundingBox:window,zoomStep:0.05,onZoom:null,flipSound:!0,flipSoundFile:["page-flip.mp3","page-flip.ogg"],flipSoundPath:"./wow_book/sound/",onPlayFlipSound:null,keyboardNavigation:{back:37,advance:39},clipBoundaries:!0,controls:{},onShowPage:!1,onHoldPage:null,onReleasePage:null};d.browser.ie8=d.browser.msie&&8==d.browser.version;var k=d.browser.msie&&9>d.browser.version?1:0,o={thin:2-k,medium:4-k,thick:6-k}})(jQuery);
(function(d){function q(j){var k=j||window.event,o=[].slice.call(arguments,1),a=0,b=0,c=0,j=d.event.fix(k);j.type="mousewheel";k.wheelDelta&&(a=k.wheelDelta/120);k.detail&&(a=-k.detail/3);c=a;void 0!==k.axis&&k.axis===k.HORIZONTAL_AXIS&&(c=0,b=-1*a);void 0!==k.wheelDeltaY&&(c=k.wheelDeltaY/120);void 0!==k.wheelDeltaX&&(b=-1*k.wheelDeltaX/120);o.unshift(j,a,b,c);return(d.event.dispatch||d.event.handle).apply(this,o)}var r=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var t=r.length;t;)d.event.fixHooks[r[--t]]=
d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var d=r.length;d;)this.addEventListener(r[--d],q,!1);else this.onmousewheel=q},teardown:function(){if(this.removeEventListener)for(var d=r.length;d;)this.removeEventListener(r[--d],q,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(d){return d?this.bind("mousewheel",d):this.trigger("mousewheel")},unmousewheel:function(d){return this.unbind("mousewheel",d)}})})(jQuery);
(function(d){function q(j){if(j in r.style)return d.support[j]=j;for(var k=t.length,o,a=j.charAt(0).toUpperCase()+j.substr(1);k--;)if(o=t[k]+a,o in r.style)return d.support[j]=o}if(d.cssHooks){var r=document.createElement("div"),t=["O","ms","Webkit","Moz"];q("transform");q("transformOrigin");q("boxSizing");d.support.boxSizing&&(d.browser.msie&&7==d.browser.version)&&(d.support.boxSizing=!1);r=null;d.support.transform&&("transform"!==d.support.transform&&!d.cssHooks.transform)&&(d.cssHooks.transform=
{get:function(j){return d.css(j,d.support.transform)},set:function(j,k){j.style[d.support.transform]=k}});d.support.transformOrigin&&("transformOrigin"!==d.support.transformOrigin&&!d.cssHooks.transformOrigin)&&(d.cssHooks.transformOrigin={get:function(j){return d.css(j,d.support.transformOrigin)},set:function(j,k){j.style[d.support.transformOrigin]=k}});d.wowBook.applyAlphaImageLoader=function(j){var k,o,a,b,c="",f=d("<div style='display:none'></div>").appendTo("body");o=0;for(a=j.length;o<a;o++){b=
j[o];f.addClass(b);if(k=f.css("background-image").match(/^url\("(.*)"\)$/)){c=c+("."+b+"{background:none; filter : progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+k[1]+"', sizingMethod='scale'); } ");f.removeClass(b)}}d("body").append("<style>"+c+"</style>")}}else alert("jQuery 1.4.3+ is needed for this plugin to work")})(jQuery);
